# sp.reverse-engineer: Reverse engineer existing codebase to generate specs

[command]
name = "sp.reverse-engineer"
description = "Reverse engineer existing codebase to generate specs, constitution, and architecture documentation"
usage = "sp.reverse-engineer [options]"
examples = [
  "sp.reverse-engineer --dir ./src",
  "sp.reverse-engineer --file main.py --output spec.md",
  "sp.reverse-engineer --pattern '*.py' --output architecture.md"
]

[parameters]
dir = { type = "string", description = "Directory to scan (default: current directory)" }
file = { type = "string", description = "Specific file to analyze" }
pattern = { type = "string", description = "Glob pattern to match files (e.g., '*.py')" }
output = { type = "string", description = "Output file for generated spec" }
exclude = { type = "string", description = "Comma-separated list of patterns to exclude" }

[behavior]
# How the command should behave
auto_detect = true  # Automatically detect project type and structure
include_tests = false  # Whether to include test files in analysis
follow_imports = true  # Follow imports to understand dependencies
generate_diagrams = true  # Generate architecture diagrams where possible

[output_options]
format = "markdown"  # Output format: markdown, json, yaml
include_examples = true  # Include usage examples in generated docs
include_implementation_notes = true  # Add implementation-specific notes
add_complexity_scores = false  # Add complexity scores for each component

[validation_rules]
# Rules for validating generated specs
require_examples = true
require_error_handling = true
require_security_considerations = true
require_performance_notes = false

# Implementation Pattern (observed in codebase):
implementation_pattern = """
class APIError(Exception):
    \"\"\"Base exception for all API errors\"\"\"

    def __init__(self, code: str, message: str, status: int = 400, details: dict = None):
        self.code = code
        self.message = message
        self.status = status
        self.details = details or {}

    def to_response(self):
        return {
            'error': {
                'code': self.code,
                'message': self.message,
                'details': self.details
            }
        }
"""